<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Ortográfico</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --primary: #8a2be2;
  --primary-light: #9c47e5;
  --accent: #bb86fc;
  --background: #121212;
  --card: #1e1e1e;
  --card-light: #2a2a2a;
  --text: #e6e6e6;
  --text-secondary: #aaa;
  --success: #03dac6;
  --warning: #ffb300;
  --danger: #cf6679;
  --transition: 0.3s;
  --border-radius: 12px;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Poppins', sans-serif;
  background: var(--background);
  color: var(--text);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  min-height: 100vh;
  padding: 20px 15px;
  line-height: 1.6;
}

.container {
  width: 100%;
  max-width: 680px;
}

.card {
  background: var(--card);
  border-radius: var(--border-radius);
  padding: 25px 20px;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
  transition: all var(--transition);
  margin-bottom: 20px;
}

.header {
  text-align: center;
  margin-bottom: 25px;
}

h1 {
  font-size: 2.2rem;
  background: linear-gradient(to right, var(--primary), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 10px;
  font-weight: 700;
}

.subtitle {
  color: var(--text-secondary);
  font-size: 1.1rem;
  margin-bottom: 5px;
}

.description {
  text-align: center;
  color: var(--text-secondary);
  margin-bottom: 25px;
  font-size: 0.95rem;
}

.button-group {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin: 25px 0;
}

button {
  padding: 16px;
  font-size: 1rem;
  font-weight: 600;
  border: none;
  border-radius: var(--border-radius);
  cursor: pointer;
  transition: all var(--transition);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

button:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

button:active {
  transform: translateY(0);
}

.easy {
  background: linear-gradient(to right, #4cc9f0, #4361ee);
  color: #fff;
}

.medium {
  background: linear-gradient(to right, #4361ee, #3a0ca3);
  color: #fff;
}

.hard {
  background: linear-gradient(to right, #3a0ca3, #7209b7);
  color: #fff;
}

.option-btn {
  background: var(--card-light);
  color: var(--text);
  margin-bottom: 12px;
  text-align: left;
  padding: 18px;
  position: relative;
  overflow: hidden;
  width: 100%;
  font-size: 1.05rem;
  border-radius: 12px;
}

.option-btn:after {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  width: 5px;
  background: transparent;
  transition: var(--transition);
}

.option-btn:hover:after {
  background: var(--primary);
}

.option-btn.correct {
  background: rgba(3, 218, 198, 0.15);
  color: var(--success);
}

.option-btn.correct:after {
  background: var(--success);
}

.option-btn.wrong {
  background: rgba(207, 102, 121, 0.15);
  color: var(--danger);
}

.option-btn.wrong:after {
  background: var(--danger);
}

.stats {
  display: flex;
  justify-content: space-between;
  font-size: 0.95rem;
  margin-bottom: 15px;
  color: var(--text-secondary);
  background: var(--card-light);
  padding: 12px 15px;
  border-radius: var(--border-radius);
}

.stat-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

#timer.time-warning {
  color: var(--warning);
  animation: pulse 1s infinite;
}

#timer.time-critical {
  color: var(--danger);
  animation: pulse 0.5s infinite;
}

@keyframes pulse {
  0% { opacity: 1; }
  50% { opacity: 0.6; }
  100% { opacity: 1; }
}

.progress-container {
  position: sticky;
  top: 8px;
  z-index: 30;
  height: 8px;
  margin-top: 8px;
  background: var(--card-light);
  border-radius: 5px;
  overflow: hidden;
}

.progress-bar {
  height: 100%;
  background: linear-gradient(to right, var(--primary), var(--accent));
  width: 0;
  transition: width var(--transition);
}

.question {
  font-size: 1.2rem;
  margin: 20px 0;
  font-weight: 500;
  line-height: 1.4;
  padding: 0 5px;
}

.controls {
  display: flex;
  justify-content: center;
  margin-top: 20px;
}

.control-btn {
  background: var(--primary);
  color: #fff;
  padding: 12px 25px;
  margin: 0 5px;
  border-radius: var(--border-radius);
  min-width: 140px;
}

.control-btn:hover {
  background: var(--primary-light);
}

.results-container {
  text-align: center;
  padding: 10px 0;
}

.results-score {
  font-size: 3rem;
  font-weight: 700;
  margin: 20px 0;
  background: linear-gradient(to right, var(--primary), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.result-message {
  background: var(--card-light);
  padding: 20px;
  border-radius: var(--border-radius);
  margin: 25px 0;
  font-size: 1.1rem;
}

.result-details {
  display: flex;
  justify-content: space-around;
  margin: 20px 0;
  flex-wrap: wrap;
  gap: 15px;
}

.detail-item {
  background: var(--card-light);
  padding: 15px;
  border-radius: var(--border-radius);
  min-width: 120px;
}

.detail-value {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--primary);
}

.detail-label {
  font-size: 0.9rem;
  color: var(--text-secondary);
}

.hidden {
  display: none;
}

.footer {
  text-align: center;
  color: var(--text-secondary);
  font-size: 0.8rem;
  margin-top: 30px;
  padding: 15px;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.fade-in {
  animation: fadeIn 0.5s ease forwards;
}

@media (max-width: 480px) {
  body {
    padding: 12px 10px;
    align-items: center;
  }
  
  .container {
    padding-bottom: 20px;
  }

  .card {
    padding: 18px 14px;
    margin-bottom: 14px;
  }
  
  h1 {
    font-size: 1.6rem;
  }
  
  .subtitle {
    font-size: 0.98rem;
  }
  
  .description {
    font-size: 0.92rem;
  }
  
  button {
    padding: 16px;
    font-size: 1rem;
    border-radius: 14px;
  }

  .button-group {
    gap: 12px;
  }

  .option-btn {
    background: var(--card-light);
    color: var(--text);
    margin-bottom: 12px;
    text-align: left;
    padding: 18px;
    position: relative;
    overflow: hidden;
    width: 100%;
    font-size: 1.05rem;
    border-radius: 12px;
  }

  .progress-container {
    position: sticky;
    top: 8px;
    z-index: 30;
    height: 8px;
    margin-top: 8px;
  }

  .question {
    font-size: 1.1rem;
    margin: 14px 0;
  }
  
  .stats {
    flex-direction: column;
    gap: 8px;
    font-size: 0.95rem;
  }
  
  .results-score {
    font-size: 2.2rem;
  }
  
  .result-details {
    flex-direction: column;
    gap: 10px;
  }
  
  .detail-item {
    width: 100%;
  }
}

@media (max-width: 350px) {
  h1 {
    font-size: 1.6rem;
  }
  
  .button-group {
    gap: 10px;
  }
  
  button {
    padding: 12px;
    font-size: 0.9rem;
  }
}
</style>
</head>
<body>
<div class="container">
  <div class="card fade-in" id="welcome-screen">
    <div class="header">
      <h1>Quiz Ortográfico</h1>
      <div class="subtitle">Encuentra la sentencia correcta</div>
    </div>
    <div class="description">
      Pon a prueba tus conocimientos de ortografía con este quiz interactivo. 
      Elige tu nivel de dificultad y demuestra tu dominio del español.
    </div>
    <div class="button-group">
      <button class="easy" data-level="easy">
        <i class="fas fa-star"></i> Fácil - 20 preguntas
      </button>
      <button class="medium" data-level="medium">
        <i class="fas fa-star-half-alt"></i> Medio - 40 preguntas
      </button>
      <button class="hard" data-level="hard">
        <i class="fas fa-fire"></i> Difícil - 80 preguntas
      </button>
    </div>
    <div class="footer">
      Desarrollado por Octavio Campana - Nicolas Cardozo - Ignacio Soria - Sebastian Albert
    </div>
  </div>

  <div class="card hidden fade-in" id="quiz-screen">
    <div class="stats">
      <div class="stat-item" id="timer">
        <i class="fas fa-clock"></i> <span id="time-left">0:00</span>
      </div>
      <div class="stat-item" id="score-display">
        <i class="fas fa-trophy"></i> <span id="score">0</span>/<span id="total-questions">0</span>
      </div>
    </div>
    <div class="progress-container">
      <div class="progress-bar" id="progress-bar"></div>
    </div>
    <div class="question" id="question"></div>
    <div class="button-group" id="options"></div>
    <div class="controls">
      <button class="control-btn" id="end-btn">
        <i class="fas fa-flag"></i> Terminar Quiz
      </button>
    </div>
  </div>

  <div class="card hidden fade-in" id="results-screen">
    <div class="header">
      <h2>¡Resultados!</h2>
      <div class="subtitle">Así te fue en el desafío</div>
    </div>
    <div class="results-container">
      <div class="results-score" id="final-score">0/0</div>
      <div class="result-message" id="result-message"></div>
      
      <div class="result-details">
        <div class="detail-item">
          <div class="detail-value" id="correct-answers">0</div>
          <div class="detail-label">Correctas</div>
        </div>
        <div class="detail-item">
          <div class="detail-value" id="incorrect-answers">0</div>
          <div class="detail-label">Incorrectas</div>
        </div>
        <div class="detail-item">
          <div class="detail-value" id="percentage">0%</div>
          <div class="detail-label">Porcentaje</div>
        </div>
      </div>
      
      <div class="controls">
        <button class="control-btn" id="restart-btn">
          <i class="fas fa-redo"></i> Jugar de Nuevo
        </button>
      </div>
    </div>
  </div>
</div>

<script>
const difficultySettings = {
  easy: { questions: 20, time: 300 },   // 5 minutos
  medium: { questions: 40, time: 900 }, // 15 minutos
  hard: { questions: 80, time: 1800 }   // 30 minutos
};

const questions = [
  { q:"El otro ___ te vi", r1:"día", r2:"diá", r3:"dias", correct:1 },
  { q:"Él no ___ venir a la fiesta", r1:"pudo", r2:"pudó", r3:"podio", correct:1 },
  { q:"Yo ___ un avión", r1:"vi", r2:"ví", r3:"bí", correct:1 },
  { q:"No me ___ mentido", r1:"has", r2:"haz", r3:"as", correct:1 },
  { q:"El niño dijo: ___", r1:"mamá", r2:"mama", r3:"mamà", correct:1 },
  { q:"La casa tiene una ___", r1:"habitación", r2:"abitación", r3:"habitacion", correct:1 },
  { q:"Vamos a ___ el problema.", r1:"solucionar", r2:"solucionár", r3:"resolver", correct:1 },
  { q:"Ese es un ___ muy valioso.", r1:"anillo", r2:"aniyo", r3:"aniello", correct:1 },
  { q:"___ hace mucho frío.", r1:"Aquí", r2:"Aki", r3:"Aqui", correct:1 },
  { q:"¿___ vas a llamar?", r1:"A quién", r2:"A quien", r3:"Aquien", correct:1 },
  { q:"Me duele la ___.", r1:"cabeza", r2:"cabeça", r3:"kabeza", correct:1 },
  { q:"___ el libro en la mesa.", r1:"Puso", r2:"Púsó", r3:"Puso", correct:1 },
  { q:"Esa es ___ opinión.", r1:"mi", r2:"mí", r3:"míi", correct:1 },
  { q:"¿___ es tu cantante favorito?", r1:"Quién", r2:"Quien", r3:"Quien", correct:1 },
  { q:"Tengo que ___ la verdad.", r1:"decir", r2:"desir", r3:"decir", correct:1 },
  { q:"El agua está ___.", r1:"fría", r2:"fria", r3:"fríá", correct:1 },
  { q:"Lo ___ con mis propios ojos.", r1:"vi", r2:"ví", r3:"ví", correct:1 },
  { q:"Necesito un ___ nuevo.", r1:"bolígrafo", r2:"boligrafo", r3:"lapicero", correct:1 },
  { q:"¿___ hora es?", r1:"Qué", r2:"Que", r3:"Ke", correct:1 },
  { q:"Eso está ___ correcto.", r1:"absolutamente", r2:"absolutaménte", r3:"totalmente", correct:1 },
  { q:"El ___ de la música.", r1:"ritmo", r2:"rítmo", r3:"ritmó", correct:2 },
  { q:"Voy ___ tienda.", r1:"a la", r2:"ala", r3:"alá", correct:1 },
  { q:"¡___ cuidado!", r1:"Ten", r2:"Tén", r3:"Tèn", correct:1 },
  { q:"El avión ___ a tiempo.", r1:"aterrizó", r2:"aterrizo", r3:"aterrisó", correct:1 },
  { q:"Es un ___ de alegría.", r1:"grito", r2:"gritó", r3:"grido", correct:1 },
  { q:"La ___ está muy cara.", r1:"gasolina", r2:"gasólina", r3:"nafta", correct:1 },
  { q:"¿___ está el supermercado?", r1:"Dónde", r2:"Donde", r3:"Dónde", correct:1 },
  { q:"___ hecho muy bien.", r1:"Has", r2:"Haz", r3:"Has", correct:1 },
  { q:"Ese es un buen ___", r1:"consejo", r2:"concejo", r3:"concejo", correct:1 },
  { q:"___ el dinero en el banco.", r1:"Ingresó", r2:"Ingreso", r3:"Depositó", correct:1 },
  { q:"La ___ de la montaña es preciosa.", r1:"cima", r2:"sima", r3:"cimá", correct:1 },
  { q:"No ___ qué decir.", r1:"sé", r2:"se", r3:"sè", correct:1 },
  { q:"Trabajo como ___", r1:"ingeniero", r2:"ingeniero", r3:"ingeneiro", correct:1 },
  { q:"¿___ quieres venir?", r1:"Cuándo", r2:"Cuando", r3:"Cuándo", correct:1 },
  { q:"Hace un día ___", r1:"espléndido", r2:"esplendido", r3:"espléndido", correct:1 },
  { q:"El rey vive en un ___", r1:"palacio", r2:"palasio", r3:"palacio", correct:1 },
  { q:"___ una carta ayer.", r1:"Escribí", r2:"Escribi", r3:"Escribí", correct:1 },
  { q:"Es ___ de azúcar.", r1:"un poco", r2:"unpoco", r3:"un poko", correct:1 },
  { q:"El tren ___ con retraso.", r1:"llegó", r2:"llego", r3:"llegó", correct:1 },
  { q:"Me gusta el ___ con leche.", r1:"café", r2:"cafe", r3:"café", correct:1 },
  { q:"___ una película muy buena.", r1:"Es", r2:"És", r3:"Es", correct:1 },
  { q:"Vamos a ___ al fútbol.", r1:"jugar", r2:"jugar", r3:"jugár", correct:1 },
  { q:"El ___ está nublado.", r1:"cielo", r2:"sielo", r3:"cielo", correct:1 },
  { q:"¿___ es eso?", r1:"Por qué", r2:"Porque", r3:"Por que", correct:1 },
  { q:"Ese sonido es muy ___", r1:"estridente", r2:"estridente", r3:"agudo", correct:1 },
  { q:"Compré ___ manzanas.", r1:"diez", r2:"diéz", r3:"diez", correct:1 },
  { q:"El jugador marcó un ___", r1:"gol", r2:"gól", r3:"goal", correct:1 },
  { q:"___ las instrucciones.", r1:"Sigue", r2:"Cigue", r3:"Sígue", correct:1 },
  { q:"La ___ de la risa.", r1:"carcajada", r2:"carcaxada", r3:"risotada", correct:1 },
  { q:"Es ___ problema.", r1:"un", r2:"ún", r3:"uno", correct:1 },
  { q:"¿___ vas de vacaciones?", r1:"Adónde", r2:"A dónde", r3:"Adonde", correct:2 },
  { q:"Tengo ___ en el brazo.", r1:"un hueso", r2:"un weso", r3:"un ueso", correct:1 },
  { q:"El libro ___ interesante.", r1:"parece", r2:"paréce", r3:"parece", correct:1 },
  { q:"Vivo en esta ___", r1:"ciudad", r2:"siudad", r3:"ciudad", correct:1 },
  { q:"___ el examen.", r1:"Aprobé", r2:"Aprobe", r3:"Aprobé", correct:1 },
  { q:"El ___ de la oficina.", r1:"jefe", r2:"gefe", r3:"jefe", correct:1 },
  { q:"¿___ es tu nombre?", r1:"Cuál", r2:"Cual", r3:"Cuál", correct:1 },
  { q:"Huele muy ___", r1:"bien", r2:"bién", r3:"bien", correct:1 },
  { q:"La luz ___ intensa.", r1:"es", r2:"és", r3:"es", correct:1 },
  { q:"Necesito ___", r1:"ayuda", r2:"alluda", r3:"auxilio", correct:1 },
  { q:"Ese animal es muy ___", r1:"raro", r2:"raro", r3:"extraño", correct:1 },
  { q:"___ el paquete por correo.", r1:"Envió", r2:"Envio", r3:"Mandó", correct:1 },
  { q:"La ___ es fundamental.", r1:"familia", r2:"família", r3:"familia", correct:1 },
  { q:"No ___ nada.", r1:"hice", r2:"ice", r3:"hisé", correct:1 },
  { q:"El ___ del equipo.", r1:"capitán", r2:"capitan", r3:"capitán", correct:1 },
  { q:"¿___ dinero tienes?", r1:"Cuánto", r2:"Cuantó", r3:"Cuánto", correct:1 },
  { q:"Está ___ llover.", r1:"a punto de", r2:"apunto de", r3:"a punto", correct:1 },
  { q:"El ___ de la discusión.", r1:"tema", r2:"téma", r3:"asunto", correct:1 },
  { q:"___ la ventana, por favor.", r1:"Cierra", r2:"Sierra", r3:"Ciérra", correct:1 },
  { q:"Tengo una ___ importante.", r1:"reunión", r2:"reunion", r3:"junta", correct:1 },
  { q:"¿___ quieres hacer?", r1:"Qué", r2:"Que", r3:"Qué", correct:1 },
  { q:"Estoy ___ acuerdo.", r1:"de", r2:"dé", r3:"en", correct:1 },
  { q:"El ___ del avión.", r1:"vuelo", r2:"buelo", r3:"vuelo", correct:1 },
  { q:"___ la llave inglesa.", r1:"Usó", r2:"Uso", r3:"Utilizó", correct:1 },
  { q:"Es un ___ de honor.", r1:"tema", r2:"téma", r3:"asunto", correct:1 },
  { q:"¿___ llegó el paquete?", r1:"Cuándo", r2:"Cuando", r3:"Cuándo", correct:1 },
  { q:"Ven ___ aquí.", r1:"para", r2:"pará", r3:"hacia", correct:1 },
  { q:"El ___ de la noticia.", r1:"impacto", r2:"impácto", r3:"impacto", correct:1 },
  { q:"___ una decisión difícil.", r1:"Es", r2:"És", r3:"Fue", correct:1 },
  { q:"Corrimos ___ la calle.", r1:"hacia", r2:"hasia", r3:"hacia", correct:1 },
  { q:"El ___ de la cerradura.", r1:"sécreto", r2:"secreto", r3:"secreto", correct:1 },
  { q:"¿___ es tu médico?", r1:"Quién", r2:"Quien", r3:"Quién", correct:1 },
  { q:"Quedó ___ segundo lugar.", r1:"en", r2:"én", r3:"de", correct:1 },
  { q:"El ___ de la operación.", r1:"éxito", r2:"exito", r3:"éxito", correct:1 },
  { q:"___ la mesa para cenar.", r1:"Puso", r2:"Pusó", r3:"Preparó", correct:1 },
  { q:"La ___ del destino.", r1:"rueda", r2:"rrueda", r3:"rueda", correct:1 },
  { q:"¿___ vas a comer?", r1:"Qué", r2:"Que", r3:"Qué", correct:1 },
  { q:"Está ___ de la casa.", r1:"dentro", r2:"déntro", r3:"adentro", correct:1 },
  { q:"El ___ del concierto.", r1:"éxito", r2:"exito", r3:"éxito", correct:1 },
  { q:"___ un buen ejemplo.", r1:"Da", r2:"Dá", r3:"Da", correct:1 },
  { q:"El ___ del reloj.", r1:"tic tac", r2:"tictac", r3:"tic-tac", correct:1 }
];

let currentQuestion=0, score=0, timeLeft=0, timer, totalQuestions=0, selectedQuestions=[];
let currentCorrect = 0; // nueva variable para rastrear índice correcto en las opciones actuales

const welcomeScreen=document.getElementById('welcome-screen');
const quizScreen=document.getElementById('quiz-screen');
const resultsScreen=document.getElementById('results-screen');
const questionEl=document.getElementById('question');
const optionsEl=document.getElementById('options');
const progressBar=document.getElementById('progress-bar');
const timeLeftEl=document.getElementById('time-left');
const scoreEl=document.getElementById('score');
const totalEl=document.getElementById('total-questions');
const finalScoreEl=document.getElementById('final-score');
const resultMessageEl=document.getElementById('result-message');
const correctAnswersEl=document.getElementById('correct-answers');
const incorrectAnswersEl=document.getElementById('incorrect-answers');
const percentageEl=document.getElementById('percentage');

// new helper to create minimal distinct variants
function makeVariant(text){
  const accents = {'a':'á','e':'é','i':'í','o':'ó','u':'ú','A':'Á','E':'É','I':'Í','O':'Ó','U':'Ú'};
  // try replacing a vowel with its accented version
  for(let i=0;i<text.length;i++){
    const c=text[i];
    if(accents[c]) return text.slice(0,i)+accents[c]+text.slice(i+1);
  }
  // fallback: swap two adjacent letters if possible
  if(text.length>1){
    return text.slice(0,1)+text[2]+text[1]+text.slice(3);
  }
  // last resort: append a soft mark
  return text + '́';
}

// Funciones
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}

function startQuiz(level){
  const settings=difficultySettings[level];
  totalQuestions=Math.min(settings.questions,questions.length);
  selectedQuestions=shuffle([...questions]).slice(0,totalQuestions);
  timeLeft=settings.time;
  score=0; currentQuestion=0;
  scoreEl.textContent=score; totalEl.textContent=totalQuestions;
  welcomeScreen.classList.add('hidden');
  quizScreen.classList.remove('hidden');
  showQuestion(); updateTimer(); startTimer();
}

function startTimer(){clearInterval(timer); timer=setInterval(()=>{timeLeft--;updateTimer();if(timeLeft<=0){clearInterval(timer);endQuiz();}},1000);}
function updateTimer(){const m=Math.floor(timeLeft/60),s=timeLeft%60;timeLeftEl.textContent=`${m}:${s.toString().padStart(2,'0')}`;}

function showQuestion(){
  if(currentQuestion>=selectedQuestions.length){endQuiz();return;}
  const q=selectedQuestions[currentQuestion];
  // construir y mezclar opciones manteniendo referencia a la correcta
  const optsArr = [{text:q.r1, idx:1},{text:q.r2, idx:2},{text:q.r3, idx:3}];
  // ensure options are minimally distinct
  const seen = new Map();
  for(let i=0;i<optsArr.length;i++){
    let t = optsArr[i].text;
    while([...seen.values()].includes(t) && t===optsArr[i].text){
      t = makeVariant(optsArr[i].text);
      // if variant still collides, slightly modify source for next attempt
      optsArr[i].text = t;
    }
    // if exact duplicates remain, ensure uniqueness by applying variant repeatedly
    let attempts = 0;
    while(seen.has(t) && attempts<5){
      t = makeVariant(t);
      optsArr[i].text = t;
      attempts++;
    }
    seen.set(i,t);
  }
  shuffle(optsArr);
  optionsEl.innerHTML='';
  optsArr.forEach((opt,i)=>{
    const btn=document.createElement('button');
    btn.className='option-btn fade-in';
    btn.textContent=`${String.fromCharCode(97+i)}) ${opt.text}`;
    btn.addEventListener('click',()=>checkAnswer(i+1, optsArr.map(o=>o.idx).indexOf(q.correct)+1));
    optionsEl.appendChild(btn);
  });
  questionEl.textContent=q.q;
  progressBar.style.width=`${((currentQuestion+1)/totalQuestions)*100}%`;
}

function checkAnswer(choice, correct){
  const opts=document.querySelectorAll('.option-btn'); opts.forEach(b=>b.disabled=true);
  if(choice===correct){opts[choice-1].classList.add('correct');score++; scoreEl.textContent = score;}
  else{opts[choice-1].classList.add('wrong');opts[correct-1].classList.add('correct');}
  setTimeout(()=>{currentQuestion++;showQuestion();},1000);
}

function endQuiz(){
  clearInterval(timer);
  quizScreen.classList.add('hidden'); resultsScreen.classList.remove('hidden');
  const incorrect=totalQuestions-score; const pct=Math.round((score/totalQuestions)*100);
  finalScoreEl.textContent=`${score}/${totalQuestions}`;
  correctAnswersEl.textContent=score; incorrectAnswersEl.textContent=incorrect; percentageEl.textContent=`${pct}%`;
  resultMessageEl.textContent=pct>=90?"¡Excelente!":pct>=70?"¡Muy bien!":pct>=50?"Buen intento":"Sigue practicando";
}

document.querySelectorAll('[data-level]').forEach(btn=>btn.addEventListener('click',()=>startQuiz(btn.dataset.level)));
document.getElementById('end-btn').addEventListener('click',endQuiz);
document.getElementById('restart-btn').addEventListener('click',()=>location.reload());
</script>
</body>
</html>
