<!DOCTYPE html><html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cubo → Presentación</title>
<style>
  :root {
    --bg: #0b0f14;
    --fg: #e6edf3;
    --muted: #9fb1c1;
    --accent: #6ee7ff;
    --cube: #121a22;
    --edge: #2a485e;
    --s: clamp(220px, 36vmin, 420px);
    --explode: calc(var(--s) * 0.9);
    --viewer-gap: clamp(10px, 3vmin, 24px);
  }
  * { box-sizing: border-box; }
  html, body { height: 100%; margin: 0; background: radial-gradient(1200px 600px at 50% 0%, #12202d, var(--bg)); color: var(--fg); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji"; }.wrap { position: relative; height: 100%; display: grid; place-items: center; } .hud { position: fixed; top: 18px; left: 50%; transform: translateX(-50%); font-size: 14px; color: var(--muted); opacity: .9; letter-spacing: .3px; } .hud a { color: var(--fg); text-decoration: none; border-bottom: 1px dashed #4d6c83; }

.scene { position: relative; width: var(--s); height: var(--s); perspective: 1200px; filter: drop-shadow(0 30px 60px rgba(0,0,0,.55)); cursor: pointer; } .cube { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 600ms cubic-bezier(.2,.9,.2,1), filter 300ms ease; will-change: transform; } @keyframes rotate { 
    0% { transform: rotateX(-22deg) rotateY(0deg) rotateZ(0deg); } 
    50% { transform: rotateX(-22deg) rotateY(180deg) rotateZ(0deg); } 
    100% { transform: rotateX(-22deg) rotateY(360deg) rotateZ(0deg); } 
  }
  .scene .cube { animation: rotate 10s linear infinite; transform-style: preserve-3d; }
  .scene:hover .cube { animation-play-state: paused; } .scene:active .cube { transform: scale(0.98) rotateX(-20deg) rotateY(6deg); }

.face { position: absolute; inset: 0; background: linear-gradient(135deg, #14202b, var(--cube)); border: 1px solid var(--edge); border-radius: 18px; box-shadow: inset 0 0 0 1px rgba(255,255,255,.03); display: grid; place-items: center; font-weight: 800; color: #9fd7ff; text-transform: uppercase; letter-spacing: 2px; transition: transform 420ms cubic-bezier(.2,.8,.2,1), box-shadow 300ms ease, opacity 300ms ease; perspective: 800px; } .face::after { content: ""; position: absolute; inset: -1px; border-radius: 18px; background: radial-gradient(240px 80px at 40% 20%, rgba(110,231,255,.12), transparent 60%); pointer-events: none; } .face:hover { transform: translateZ(6px) rotateX(-1deg); box-shadow: 0 8px 24px rgba(0,0,0,.45); }

.front  { transform: translateZ(calc(var(--s) / 2)); } .back   { transform: rotateY(180deg) translateZ(calc(var(--s) / 2)); } .right  { transform: rotateY(90deg)  translateZ(calc(var(--s) / 2)); } .left   { transform: rotateY(-90deg) translateZ(calc(var(--s) / 2)); } .top    { transform: rotateX(90deg)  translateZ(calc(var(--s) / 2)); } .bottom { transform: rotateX(-90deg) translateZ(calc(var(--s) / 2)); }

.glow { position: absolute; inset: 0; background: radial-gradient(60% 80% at 50% 60%, rgba(110,231,255,.15), transparent 70%); filter: blur(40px); z-index: -1; opacity: .8; }

.scene.open .cube { animation: none; transform: rotateX(-10deg) rotateY(25deg) scale(0.98); } .scene.open .face { transition: transform 1000ms cubic-bezier(.15,.85,.15,1), opacity 600ms ease; } .scene.open .front  { transform: translateZ(calc(var(--s) / 2 + var(--explode))) rotateY(2deg) rotateX(-2deg); } .scene.open .back   { transform: rotateY(180deg) translateZ(calc(var(--s) / 2 + var(--explode))) rotateY(-6deg); } .scene.open .right  { transform: rotateY(90deg)  translateZ(calc(var(--s) / 2 + var(--explode))) rotateZ(6deg); } .scene.open .left   { transform: rotateY(-90deg) translateZ(calc(var(--s) / 2 + var(--explode))) rotateZ(-6deg); } .scene.open .top    { transform: rotateX(90deg)  translateZ(calc(var(--s) / 2 + var(--explode))) rotateZ(4deg); } .scene.open .bottom { transform: rotateX(-90deg) translateZ(calc(var(--s) / 2 + var(--explode))) rotateZ(-4deg); }

.cta { position: absolute; bottom: -56px; left: 50%; transform: translateX(-50%); font-size: 13px; color: var(--muted); opacity: .9; }

.viewer { position: fixed; inset: clamp(12px, 3vmin, 24px); display: grid; grid-template-rows: auto 1fr; gap: 12px; opacity: 0; pointer-events: none; transition: transform 420ms cubic-bezier(.2,.9,.2,1), opacity 300ms ease; transform: translateY(8px); } .viewer.visible { opacity: 1; pointer-events: auto; transform: translateY(0); inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(6px); z-index: 60; }
/* center the iframe content and constrain its max width so it appears centered on large screens */
.stage { display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; padding: 36px; box-sizing: border-box; }
.stage > iframe { width: 100%; max-width: 1100px; height: calc(100vh - 72px); border: 0; border-radius: 8px; background: white; display: block; }

.empty { display: grid; place-items: center; border: 1px dashed #29465a; border-radius: 16px; padding: 18px; text-align: center; gap: 6px; font-size: 14px; } .empty strong { color: var(--fg); }

@media (max-width:520px) {
  .hud { display: none; }
  .cta { bottom: -48px; font-size: 12px; }
  .face { border-radius: 12px; }

  /* rotate viewer into landscape on small portrait devices */
  .viewer.rotated { align-items: center; justify-items: center; inset: 0; background: rgba(0,0,0,0.65); }
  .viewer.rotated .stage { display:flex; align-items:center; justify-content:center; padding: 0; height:100vh; box-sizing: border-box; overflow: hidden; }
  .viewer.rotated .stage > iframe {
    /* rotate into landscape and size to fill mobile screen cleanly */
    width: calc(100vh);
    height: calc(100vw);
    max-width: none;
    max-height: none;
    transform: rotate(90deg);
    transform-origin: center center;
    border-radius: 0;
    margin: 0;
    display: block;
    position: static;
  }
}
</style>

</head>
<body>
  <div class="hud" aria-hidden="true"></div>
  <div class="wrap">
    <div class="scene" id="scene" aria-label="Cubo que se desarma y revela la presentación">
      <div class="cube" id="cube">
        <div class="face front"><span class="label">Eva</span></div>
        <div class="face back"><span class="label">Eva</span></div>
        <div class="face right"><span class="label">Eva</span></div>
        <div class="face left"><span class="label">Eva</span></div>
        <div class="face top"><span class="label">Eva</span></div>
        <div class="face bottom"><span class="label">Eva</span></div>
        <div class="glow"></div>
      </div>
      <div class="cta" aria-hidden="true"></div>
    </div>
  </div>  
  <div class="viewer" id="viewer">
    <div id="stage" class="stage">
      <div class="empty" id="empty">
        <div><strong>Falta la presentación.</strong></div>
        <div>Usá <span class="kbd">?pptx=URL_PUBLICA.pptx</span> o subila a OneDrive/Dropbox con enlace público.</div>
        <div class="hint">Se usa el visor de Office en modo embed.</div>
      </div>
    </div>
  </div><script>
  const qs = new URLSearchParams(location.search);
  // default to the provided GitHub raw PPTX if no ?pptx= is supplied
  const src = qs.get('pptx') || 'https://raw.githubusercontent.com/EnttbotX/EnttbotX.github.io/main/Eva-Peron-De-Actriz-a-Leyenda.pptx_20250904_104353_0000.pptx';
  const scene = document.getElementById('scene');
  const viewer = document.getElementById('viewer');
  const stage = document.getElementById('stage');
  const empty = document.getElementById('empty');
  const cube = document.getElementById('cube');

  function buildEmbed(u){
    return 'https://view.officeapps.live.com/op/embed.aspx?src=' + encodeURIComponent(u);
  }

  function showViewer(){
    viewer.classList.add('visible');
  }

  function mountFrame(u){
    stage.innerHTML = '';
    if(!u){ stage.appendChild(empty); return; }
    const iframe = document.createElement('iframe');
    iframe.allowFullscreen = true;
    iframe.referrerPolicy = 'no-referrer';
    iframe.src = buildEmbed(u);
    stage.appendChild(iframe);
  }

  // open the cube and reveal viewer; on mobile allow re-open by tapping again
  scene.addEventListener('click', () => {
    scene.classList.toggle('open');
    if(scene.classList.contains('open')) {
      // mount the PPTX, prevent back while viewer is visible, then show viewer after the explode animation
      mountFrame(src);
      // push a history entry so back button is intercepted
      history.pushState({viewer:'open'}, '', '#viewer');
      setTimeout(() => { showViewer(); }, 520);
    } else {
      viewer.classList.remove('visible');
    }
  });

  // Prevent back navigation from closing the viewer: when user hits back, re-push state and keep viewer open
  window.addEventListener('popstate', (e) => {
    // if viewer visible, keep it and re-add history entry
    if(viewer.classList.contains('visible')) {
      history.pushState({viewer:'open'}, '', '#viewer');
      // ensure viewer remains visible
      viewer.classList.add('visible');
      scene.classList.add('open');
    }
  });

  // mobile rotate support: on small portrait screens rotate the viewer iframe to landscape
  function applyMobileRotate(){
    const isSmall = window.innerWidth <= 520;
    const isPortrait = window.matchMedia && window.matchMedia('(orientation: portrait)').matches;
    if(isSmall && isPortrait){
      viewer.classList.add('rotated');
    } else {
      viewer.classList.remove('rotated');
    }
  }

  window.addEventListener('resize', applyMobileRotate);
  window.addEventListener('orientationchange', () => { setTimeout(applyMobileRotate, 160); });
  // initial
  applyMobileRotate();

  mountFrame(src);
  // If a pptx param is present, peek animation: auto-open on first load for smoother experience
  if(qs.get('pptx')) {
    setTimeout(()=>{ scene.classList.add('open'); mountFrame(src); showViewer(); history.replaceState({viewer:'open'}, '', '#viewer'); }, 420);
  }
  // subtle idle pulse on cube shadow for motion
  setInterval(()=> { cube.style.filter = 'drop-shadow(0 36px 64px rgba(0,0,0,.6))'; setTimeout(()=>cube.style.filter='drop-shadow(0 30px 60px rgba(0,0,0,.55))', 900); }, 3800);
</script></body>
</html>
